{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.search-form');\nconst listOfPictures = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more');\nconst loader = document.querySelector('.loader-block');\n\nconst gallerySimpleLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet page = 1;\nlet textToSearch = '';\n\nlistOfPictures.innerHTML = '';\nform.addEventListener('submit', submitHandler);\n\nloadMoreButton.addEventListener('click', loadMoreHandler);\n\nasync function submitHandler(event) {\n  page = 1;\n  textToSearch = form.elements.searchText.value.trim();\n  iziToast.destroy();\n  if (textToSearch === '') {        \n    alert(\"Search form can't be empty, enter there some text for images search.\");\n    return\n  } else {\n    event.preventDefault();\n    listOfPictures.innerHTML = '';\n    loader.classList.remove('hidden');\n    loadMoreButton.classList.add('hidden');\n    try {\n      const data = await servicePictures();\n      if (Array.from(data.data.hits).length === 0) {\n        iziToast.show({          \n          message: `Sorry, there are no images matching your search query. Please try again.`,\n          close: false,\n          backgroundColor: 'red',\n          messageColor: 'white',\n          messageSize: 20,\n          timeout: 5000,\n          maxWidth: '400px',\n          position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n        });\n      } else if (Array.from(data.data.hits).length < 40) {\n        listOfPictures.insertAdjacentHTML(\n          'beforeend',\n          createMarkup(data.data.hits)\n        );\n        gallerySimpleLightbox.refresh();        \n        form.reset();\n      } else {\n        loadMoreButton.classList.remove('hidden');\n        listOfPictures.insertAdjacentHTML('beforeend', createMarkup(data.data.hits));\n        gallerySimpleLightbox.refresh();\n        form.reset();\n      }\n    } catch {\n      iziToast.show({\n        title: 'Error',\n        message: `Something goes wrong, please try reload page.`,\n        close: false,\n        backgroundColor: 'red',\n        messageColor: 'white',\n        messageSize: 20,\n        timeout: 0,\n        position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n      });\n    }\n    loader.classList.add('hidden');\n  }\n}\n\nasync function loadMoreHandler() {\n    page += 1;\n    iziToast.destroy();\n    loader.classList.remove('hidden');\n    try {\n      const data = await servicePictures(page);\n      if ((page + 1) * 40 >= data.data.totalHits) {\n        loadMoreButton.classList.add('hidden');\n        iziToast.show({\n          message: `End of the collection of \"${textToSearch}\" exceeded.`,\n          close: false,\n          backgroundColor: 'red',\n          messageColor: 'white',\n          messageSize: 20,\n          timeout: 2000,\n          position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n        });\n      }\n      listOfPictures.insertAdjacentHTML('beforeend', createMarkup(data.data.hits));\n      gallerySimpleLightbox.refresh();\n      const galleryCard = document.querySelector('.photo-card');\n      const rect = galleryCard.getBoundingClientRect();      \n      window.scrollBy({\n        top: rect.height * 2 + 24,\n        behavior: \"smooth\",\n      });\n    } catch {\n      iziToast.show({\n        title: 'Error',\n        message: `Something goes wrong, please try reload page.`,\n        close: false,\n        backgroundColor: 'red',\n        messageColor: 'white',\n        messageSize: 20,\n        timeout: 0,\n        position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n      });\n    }\n    loader.classList.add('hidden');\n  }\n\nasync function servicePictures(page = 1) {\n  const optionsAxios = {\n    params: {\n      key: '40858721-2ab2962236a746e97c71283b6',\n      q: textToSearch,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: 40,\n    },\n  };\n  const pictures = await axios.get('https://pixabay.com/api/', optionsAxios);\n  return pictures;\n}\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        largeImageURL,\n      }) =>\n        `<div class=\"photo-card\">\n        <a href=\"${largeImageURL}\">\n      <img class=\"item-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"400\" height=\"240\" loading=\"lazy\" />\n      </a>\n      <div class=\"info\"><p class=\"info-item\"><b>Likes</b><br>${likes}</p>\n      <p class=\"info-item\"><b>Views</b><br>${views}</p>\n      <p class=\"info-item\"><b>Comments</b><br>${comments}</p>\n      <p class=\"info-item\"><b>Downloads</b><br>${downloads}</p></div></div>`\n    )\n    .join('');\n}\n"],"names":["form","listOfPictures","loadMoreButton","loader","gallerySimpleLightbox","SimpleLightbox","page","textToSearch","submitHandler","loadMoreHandler","event","iziToast","data","servicePictures","createMarkup","rect","optionsAxios","axios","arr","webformatURL","tags","likes","views","comments","downloads","largeImageURL"],"mappings":"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"}